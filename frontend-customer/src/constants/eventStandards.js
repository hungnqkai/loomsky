/*
File: src/constants/eventStandards.js
- Frontend event definitions v·ªõi UI metadata
- Standardized event categories v√† descriptions
- Visual indicators v√† Facebook mapping display
*/

/**
 * Event Categories v·ªõi UI metadata
 */
export const EVENT_CATEGORIES = {
  NAVIGATION: {
    key: 'navigation',
    name: 'Navigation',
    icon: 'mdi-compass-outline',
    color: '#3b82f6',
    description: 'Page navigation v√† session tracking'
  },
  ECOMMERCE: {
    key: 'ecommerce',
    name: 'E-commerce',
    icon: 'mdi-cart-outline',
    color: '#10b981', 
    description: 'Shopping v√† purchase events'
  },
  CONVERSION: {
    key: 'conversion',
    name: 'Conversion',
    icon: 'mdi-target',
    color: '#f59e0b',
    description: 'Goals v√† conversion tracking'
  },
  ENGAGEMENT: {
    key: 'engagement',
    name: 'Engagement',
    icon: 'mdi-chart-line',
    color: '#8b5cf6',
    description: 'User engagement measurements'
  },
  INTERACTION: {
    key: 'interaction',
    name: 'Interaction',
    icon: 'mdi-cursor-default-click-outline',
    color: '#ef4444',
    description: 'User interactions v√† clicks'
  }
};

/**
 * Standardized Events v·ªõi UI metadata
 */
export const STANDARD_EVENTS = {
  // üß≠ Navigation Events
  PAGE_VIEW: {
    name: 'PageView',
    title: 'Page View',
    category: EVENT_CATEGORIES.NAVIGATION,
    facebook_event: 'PageView',
    description: 'Theo d√µi l∆∞·ª£t xem trang',
    icon: 'mdi-file-document-outline',
    ui_metadata: {
      groupName: 'Navigation',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: true,
      complexity: 'basic'
    }
  },
  SESSION_START: {
    name: 'SessionStart',
    title: 'Session Start',
    category: EVENT_CATEGORIES.NAVIGATION,
    facebook_event: null,
    description: 'B·∫Øt ƒë·∫ßu phi√™n truy c·∫≠p',
    icon: 'mdi-play-circle-outline',
    ui_metadata: {
      groupName: 'Navigation',
      showInStandardList: false,
      isPopular: false,
      defaultEnabled: true,
      complexity: 'basic'
    }
  },

  // üõí E-commerce Events
  VIEW_CONTENT: {
    name: 'ViewContent',
    title: 'View Content',
    category: EVENT_CATEGORIES.ECOMMERCE,
    facebook_event: 'ViewContent',
    description: 'Xem chi ti·∫øt s·∫£n ph·∫©m',
    icon: 'mdi-eye-outline',
    ui_metadata: {
      groupName: 'E-commerce',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  },
  ADD_TO_CART: {
    name: 'AddToCart',
    title: 'Add to Cart',
    category: EVENT_CATEGORIES.ECOMMERCE,
    facebook_event: 'AddToCart',
    description: 'Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng',
    icon: 'mdi-cart-plus',
    ui_metadata: {
      groupName: 'E-commerce',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  },
  INITIATE_CHECKOUT: {
    name: 'InitiateCheckout',
    title: 'Initiate Checkout',
    category: EVENT_CATEGORIES.ECOMMERCE,
    facebook_event: 'InitiateCheckout',
    description: 'B·∫Øt ƒë·∫ßu qu√° tr√¨nh thanh to√°n',
    icon: 'mdi-cash-register',
    ui_metadata: {
      groupName: 'E-commerce',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'advanced'
    }
  },
  ADD_PAYMENT_INFO: {
    name: 'AddPaymentInfo',
    title: 'Add Payment Info',
    category: EVENT_CATEGORIES.ECOMMERCE,
    facebook_event: 'AddPaymentInfo',
    description: 'Nh·∫≠p th√¥ng tin thanh to√°n',
    icon: 'mdi-credit-card-outline',
    ui_metadata: {
      groupName: 'E-commerce',
      showInStandardList: true,
      isPopular: false,
      defaultEnabled: false,
      complexity: 'advanced'
    }
  },
  PURCHASE: {
    name: 'Purchase',
    title: 'Purchase',
    category: EVENT_CATEGORIES.ECOMMERCE,
    facebook_event: 'Purchase',
    description: 'Ho√†n t·∫•t mua h√†ng',
    icon: 'mdi-shopping',
    ui_metadata: {
      groupName: 'E-commerce',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'advanced'
    }
  },

  // üéØ Conversion Events
  LEAD: {
    name: 'Lead',
    title: 'Lead',
    category: EVENT_CATEGORIES.CONVERSION,
    facebook_event: 'Lead',
    description: 'Kh√°ch h√†ng ti·ªÅm nƒÉng',
    icon: 'mdi-account-plus-outline',
    ui_metadata: {
      groupName: 'Conversion',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  },
  COMPLETE_REGISTRATION: {
    name: 'CompleteRegistration',
    title: 'Complete Registration',
    category: EVENT_CATEGORIES.CONVERSION,
    facebook_event: 'CompleteRegistration',
    description: 'Ho√†n t·∫•t ƒëƒÉng k√Ω t√†i kho·∫£n',
    icon: 'mdi-account-check-outline',
    ui_metadata: {
      groupName: 'Conversion',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  },
  FORM_SUBMIT: {
    name: 'FormSubmit',
    title: 'Form Submit',
    category: EVENT_CATEGORIES.CONVERSION,
    facebook_event: 'Lead',
    description: 'G·ª≠i form li√™n h·ªá',
    icon: 'mdi-form-select',
    ui_metadata: {
      groupName: 'Conversion',
      showInStandardList: true,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  },

  // üëÜ Engagement Events
  SCROLL_DEPTH_25: {
    name: 'ScrollDepth25',
    title: '25% Scroll Depth',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: 'Cu·ªôn trang ƒë·∫øn 25%',
    icon: 'mdi-arrow-down',
    ui_metadata: {
      groupName: 'Scroll Tracking',
      showInStandardList: false,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },
  SCROLL_DEPTH_50: {
    name: 'ScrollDepth50',
    title: '50% Scroll Depth',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: 'Cu·ªôn trang ƒë·∫øn 50%',
    icon: 'mdi-arrow-down',
    ui_metadata: {
      groupName: 'Scroll Tracking',
      showInStandardList: false,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },
  SCROLL_DEPTH_75: {
    name: 'ScrollDepth75',
    title: '75% Scroll Depth',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: 'Cu·ªôn trang ƒë·∫øn 75%',
    icon: 'mdi-arrow-down',
    ui_metadata: {
      groupName: 'Scroll Tracking',
      showInStandardList: false,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },
  TIME_ON_PAGE_15S: {
    name: 'TimeOnPage15s',
    title: '15 Seconds Time',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: '·ªû l·∫°i trang 15 gi√¢y',
    icon: 'mdi-timer-outline',
    ui_metadata: {
      groupName: 'Time Engagement',
      showInStandardList: false,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },
  TIME_ON_PAGE_30S: {
    name: 'TimeOnPage30s',
    title: '30 Seconds Time',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: '·ªû l·∫°i trang 30 gi√¢y',
    icon: 'mdi-timer-outline',
    ui_metadata: {
      groupName: 'Time Engagement',
      showInStandardList: false,
      isPopular: true,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },
  TIME_ON_PAGE_60S: {
    name: 'TimeOnPage60s',
    title: '60 Seconds Time',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: '·ªû l·∫°i trang 60 gi√¢y',
    icon: 'mdi-timer-outline',
    ui_metadata: {
      groupName: 'Time Engagement',
      showInStandardList: false,
      isPopular: false,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },
  TIME_ON_PAGE_90S: {
    name: 'TimeOnPage90s',
    title: '90 Seconds Time',
    category: EVENT_CATEGORIES.ENGAGEMENT,
    facebook_event: null,
    description: '·ªû l·∫°i trang 90 gi√¢y',
    icon: 'mdi-timer-outline',
    ui_metadata: {
      groupName: 'Time Engagement',
      showInStandardList: false,
      isPopular: false,
      defaultEnabled: false,
      complexity: 'basic'
    }
  },

  // üîó Interaction Events
  CLICK_ELEMENT: {
    name: 'ClickElement',
    title: 'Click Element',
    category: EVENT_CATEGORIES.INTERACTION,
    facebook_event: null,
    description: 'Click v√†o element c·ª• th·ªÉ',
    icon: 'mdi-cursor-default-click',
    ui_metadata: {
      groupName: 'Interactions',
      showInStandardList: false,
      isPopular: false,
      defaultEnabled: false,
      complexity: 'advanced'
    }
  },
  VIDEO_PLAY: {
    name: 'VideoPlay',
    title: 'Video Play',
    category: EVENT_CATEGORIES.INTERACTION,
    facebook_event: null,
    description: 'Ph√°t video',
    icon: 'mdi-play-circle-outline',
    ui_metadata: {
      groupName: 'Interactions',
      showInStandardList: false,
      isPopular: false,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  },
  VIDEO_COMPLETE: {
    name: 'VideoComplete',
    title: 'Video Complete',
    category: EVENT_CATEGORIES.INTERACTION,
    facebook_event: null,
    description: 'Ho√†n th√†nh xem video',
    icon: 'mdi-check-circle-outline',
    ui_metadata: {
      groupName: 'Interactions',
      showInStandardList: false,
      isPopular: false,
      defaultEnabled: false,
      complexity: 'intermediate'
    }
  }
};

/**
 * Migration mapping t·ª´ old names sang new names
 */
export const EVENT_MIGRATION_MAP = {
  'PageView': 'PageView', // Already correct
  'ViewContent': 'ViewContent', // Already correct
  'AddToCart': 'AddToCart', // Already correct
  'Purchase': 'Purchase', // Already correct
  'Lead': 'Lead', // Already correct
  'CompleteRegistration': 'CompleteRegistration', // Already correct
  
  // Old custom events c·∫ßn migrate
  'scroll_25': 'ScrollDepth25',
  'scroll_50': 'ScrollDepth50',
  'scroll_75': 'ScrollDepth75',
  'scroll_90': 'ScrollDepth75', // Map 90% to 75% as per new standard
  'time_10s': 'TimeOnPage15s', // Map 10s to 15s as per new standard
  'time_30s': 'TimeOnPage30s',
  'time_1m': 'TimeOnPage60s',
  'time_1_5m': 'TimeOnPage60s', // Map longer times to 60s
  'time_2m': 'TimeOnPage60s',
  'time_3m': 'TimeOnPage60s',
  'time_5m': 'TimeOnPage60s'
};

/**
 * Helper Functions cho Frontend
 */

/**
 * Get events by category
 */
export const getEventsByCategory = (categoryKey) => {
  return Object.values(STANDARD_EVENTS).filter(event => event.category.key === categoryKey);
};

/**
 * Get events by group name (UI grouping)
 */
export const getEventsByGroup = (groupName) => {
  return Object.values(STANDARD_EVENTS).filter(event => event.ui_metadata.groupName === groupName);
};

/**
 * Get popular events
 */
export const getPopularEvents = () => {
  return Object.values(STANDARD_EVENTS).filter(event => event.ui_metadata.isPopular);
};

/**
 * Get events that should show in standard list
 */
export const getStandardListEvents = () => {
  return Object.values(STANDARD_EVENTS).filter(event => event.ui_metadata.showInStandardList);
};

/**
 * Get Facebook compatible events
 */
export const getFacebookCompatibleEvents = () => {
  return Object.values(STANDARD_EVENTS).filter(event => event.facebook_event !== null);
};

/**
 * Get default enabled events
 */
export const getDefaultEnabledEvents = () => {
  return Object.values(STANDARD_EVENTS)
    .filter(event => event.ui_metadata.defaultEnabled)
    .map(event => event.name);
};

/**
 * Get event groups
 */
export const getEventGroups = () => {
  const groups = {};
  Object.values(STANDARD_EVENTS).forEach(event => {
    const groupName = event.ui_metadata.groupName;
    if (!groups[groupName]) {
      groups[groupName] = {
        name: groupName,
        events: [],
        category: event.category
      };
    }
    groups[groupName].events.push(event);
  });
  return Object.values(groups);
};

/**
 * Migrate old event name to new standardized name
 */
export const migrateEventName = (oldName) => {
  return EVENT_MIGRATION_MAP[oldName] || oldName;
};

/**
 * Check if event is Facebook compatible
 */
export const isFacebookCompatible = (eventName) => {
  const event = Object.values(STANDARD_EVENTS).find(e => e.name === eventName);
  return event && event.facebook_event !== null;
};

/**
 * Get Facebook event name
 */
export const getFacebookEventName = (eventName) => {
  const event = Object.values(STANDARD_EVENTS).find(e => e.name === eventName);
  return event ? event.facebook_event : null;
};

/**
 * Get event definition by name
 */
export const getEventDefinition = (eventName) => {
  return Object.values(STANDARD_EVENTS).find(event => event.name === eventName) || null;
};